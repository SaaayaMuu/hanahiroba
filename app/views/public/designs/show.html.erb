<head>
<style>

.design-show-body {
  font-family: 'Kaisei Tokumin', serif;
  font-weight: bold;
}
.design-box2 {
  width: 80%;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  margin: 0 auto;
}

.design-content {
  width: 450px;
  height: auto;
  margin-left: 20px;
}
.design-content p {
  font-size: 1rem;
}

.design-content p:nth-child(3) {
  margin-top: 20px;
}

.slider6-wrap {
  width: 450px;/*sliderメイン画像横幅*/
  position: relative;
}
.slider-6 .slick-slide {
  height: auto;/*sliderメイン画像高さ*/
  overflow: hidden;
  display: flex;
  flex-wrap: wrap;
}
.slider-6 .slick-slide img {
  display: block;
  width: 100%;
  height: auto;
  object-fit: contain;/*アスペクト比を維持したまま、枠に収まるように拡大縮小される。*/
}
.thumbs_dots {
  margin: 10px 0 0;
}
.thumbs_list li {
  display: inline-block;
  width: 25%;
  padding-top:25%;/*高さをwidthと同じ値にする*/
  opacity: 0.4;
  cursor: pointer;
  transition: opacity 0.3s;
}
.thumbs_list li.slick-active {
  opacity: 1;
}


.item-box {
  width: 70%;
  display: flex;
  flex-wrap: wrap;
  justify-content: start;
  margin: 0 auto;
  margin-top: 50px;
}
.item-form {
  width: 185px;
  margin: 0 20px 20px 0;
}

.item-content img {
  width: 100%;
  height: auto;
}

.item-box p {
  font-size: 15px;
}
.item-box p:nth-child(7),p:nth-child(8) {
  text-align: center;
  margin: 0;
}


.custom-item-content {
  width: 100%;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;/*左右中央*/
  align-items: center;/*上下中央*/
}

.custom-item-form {
  width: 100%;
}

svg {
  height: 260px;
  width: 260px;
}
.colorpicker-box {
  width: 250px;
  text-align: center;/*左右中央*/
}

.custom-item-submit {
  margin-top: 50px;
}

.btn-blue {
  color: white;
  background: #008080;

}

.btn-item {
  margin: 0 auto;
  padding: 5px 2px;
}


@media screen and (max-width: 1200px) {/*1000px以上の時*/
.slider6-wrap {
  width: 40%;/*sliderメイン画像横幅*/
}
.design-content {
  width: 40%;
}
.item-form {
  width: 25%;
  margin: 0 20px 20px 0;
}
}
@media screen and (max-width: 768px) {
.slider6-wrap {
  width: 45%;/*sliderメイン画像横幅*/
}
.design-content {
  width: 45%;
}
.item-box p {
  font-size: 12px;
  margin-bottom: 2px;
}
.btn-item {
  font-size: 12px;
}
@media screen and (max-width: 576px) {/*576px以下の時*/
.slider6-wrap {
  width: 90%;//sliderメイン画像横幅
  position: relative;
}
.design-content {
  width: 90%;
  margin-left: 0;
}
.item-form {
  width: 30%;
  margin: 0 10px 10px 0;
}
.item-box p {
  font-size: 8px;
  margin-bottom: 2px;
}
.btn-item {
  font-size: 8px;
}
}

@media screen and (max-width: 425px) {/*425px以下の時*/
.item-form {
  width: 40%;
  margin: 0 10px 10px 0;
}
.design-box2 {
  width: 95%;
}
.item-box p {
  font-size: 6px;
  margin-bottom: 0;
}
.btn-item {
  font-size: 3px;
}
</style>
</head>

<body>
<%= render 'layouts/header', genre: @genre %>

<div class="body">

    <div class="design-box2">
        <div class="slider6-wrap">
            <ul class="slider-6" id="js-slider-6">
            <% @design.images.each do |image| %>
                <li><%= image_tag image %></li><!--.variant(resize: "200x200")-->
            <% end %>
            </ul>
            <div class="thumbs_dots"></div>
        </div>
        <div class="design-content">
            <h4><%= @design.design_name %></h4>
            <p><%= @design.design_introduction %></p>
            <p><%= "￥" %><%= @design.with_tax_price %><%= "～" %></p>
        </div>
    </div>


    <div class="item-box">
      <% @items.each do |item| %>
        <% if item.image.attached? %>
          <%= form_with model: @cart_item, url: cart_items_path, method: :post, local: true, class: "item-form" do |f| %>
            <%= f.hidden_field :amount, :value => "1" %>
            <%= f.hidden_field :item_id, :value => item.id %>
            <div class="item-content">
                <%= image_tag item.image %><!--.variant(resize: "200x00")-->
                <p><%= item.design.design_name %></p>
                <p><%= item.item_introduction %></p>
                <p>￥<%= item.with_tax_price %>(税込)</p>
                <p>残り<%= item.stock %>個</p>
                <% if item.is_active == true && item.stock >= 1 %> <!--販売中の商品、または在庫が1つ以上ある商品の場合-->
                    <p><%= f.submit "カートに入れる", class: "btn btn-item btn-blue" %></p>
                <% else %>
                    <p class="text-danger">販売停止中</p>
                <% end %>
            </div>
          <% end %>
        <% elsif item.custom_images.attached? %>
          <%= form_with model: @cart_item, url: cart_items_path, method: :post, local: true, class: "custom-item-form" do |f| %>
            <%= f.hidden_field :amount, :value => "1" %>
            <%= f.hidden_field :item_id, :value => item.id %>
            <div class="custom-item-content">
              <svg id="svg" xmlns="http://www.w3.org/2000/svg">
                <!--左真横 上円＆下円-->
                <path d="M 130 130 C 120 110, 40 110, 30 130
                         M 130 130 C 120 150, 40 150, 30 130" stroke="black" stroke-width="2" fill="white" id="left"/>

                <!--右真横　上＆下-->
                <path d="M 130 130 C 140 110, 220 110, 230 130
                         M 130 130 C 140 150, 220 150, 230 130" stroke="black" stroke-width="2" fill="white" id="right"/>

                <!--上　左＆右-->
                <path d="M 130 130 C 110 120, 110 40, 130 30
                         M 130 130 C 150 120, 150 40, 130 30" stroke="black" stroke-width="2" fill="white" id="toptop"/>

                <!--下　左＆右-->
                <path d="M 130 130 C 110 140, 110 220, 130 230
                         M 130 130 C 150 140, 150 220, 130 230" stroke="black" stroke-width="2" fill="white" id="bottom"/>

                <!--左上　右&左-->
                <path d="M 130 130 C 120 90, 100 70, 60 60
                         M 130 130 C 90 120, 70 110, 60 60" stroke="black" stroke-width="2" fill="white" id="lefttop"/>


                <!--左下　左＆右-->
                <path d="M 130 130 C 90 140, 70 170, 60 210
                         M 130 130 C 120 170, 110 190, 60 210" stroke="black" stroke-width="2" fill="white" id="leftbottom"/>

                <!--右上　左＆右-->
                <path d="M 130 130 C 140 90, 160 70, 200 60
                         M 130 130 C 170 120, 190 110, 200 60" stroke="black" stroke-width="2" fill="white" id="righttop"/>

                <!--右下　左＆右-->
                <path d="M 130 130 C 140 170, 150 190, 200 210
                         M 130 130 C 170 140, 190 170, 200 210" stroke="black" stroke-width="2" fill="white" id="rightbottom"/>

              </svg>
            <div class="colorpicker-box">
                <p>カラーを選択してください。</p>
                <label>①の色選択
                  <input id="colorPicker1" type="color" name="favorite_color">
                </label><br>
                <label>②の色選択
                  <input id="colorPicker2" type="color" name="favorite_color">
                </label><br>
                <label>③の色選択
                  <input id="colorPicker3" type="color" name="favorite_color">
                </label><br>
                <label>④の色選択
                  <input id="colorPicker4" type="color" name="favorite_color">
                </label><br>
                <label>⑤の色選択
                  <input id="colorPicker5" type="color" name="favorite_color">
                </label><br>
                <label>⑥の色選択
                  <input id="colorPicker6" type="color" name="favorite_color">
                </label><br>
                <label>⑦の色選択
                  <input id="colorPicker7" type="color" name="favorite_color">
                </label><br>
                <label>⑧の色選択
                  <input id="colorPicker8" type="color" name="favorite_color">
                </label>
            </div>
            <div class="custom-item-submit">
              <% if item.is_active == true && item.stock >= 1 %> <!--販売中の商品、または在庫が1つ以上ある商品の場合-->
                  <%= f.submit "色選択した商品をカートに入れる", class: "btn btn-custom btn-blue" %>
              <% else %>
                  <p class="text-danger">販売停止中</p>
              <% end %>
            </div>
          </div>
          <% end %>
        <% end %>
      <% end %>
    </div>
  <canvas id="canvas" width="260" height="260">


<!--<img src="images/tsumami2_3.png" alt="画像" width="200" height="150">-->


</body>
<script>
  // var d = document;

  // var 1 = d.getElementById("colorPicker1").value;
  // var 2 = d.getElementById("colorPicker2").value;
  // var 3 = d.getElementById("colorPicker3").value;
  // var 4 = d.getElementById("colorPicker4").value;
  // var 5 = d.getElementById("colorPicker5").value;
  // var 6 = d.getElementById("colorPicker6").value;
  // var 7 = d.getElementById("colorPicker7").value;
  // var 8 = d.getElementById("colorPicker8").value;

  let toptop = document.getElementById('toptop');
  let colorPicker1 = document.getElementById('colorPicker1');
  colorPicker1.value = "#00F000";
  colorPicker1.addEventListener('change', function(){
    toptop.style.fill = this.value;
  });

  let righttop = document.getElementById('righttop');
  let colorPicker2 = document.getElementById('colorPicker2');
  colorPicker2.value = "#00F000";
  colorPicker2.addEventListener('change', function(){
    righttop.style.fill = this.value;
  });

  let right = document.getElementById('right');
  let colorPicker3 = document.getElementById('colorPicker3');
  colorPicker3.value = "#00F000";
  colorPicker3.addEventListener('change', function(){
    right.style.fill = this.value;
  });

  let rightbottom = document.getElementById('rightbottom');
  let colorPicker4 = document.getElementById('colorPicker4');
  colorPicker4.value = "#00F000";
  colorPicker4.addEventListener('change', function(){
    rightbottom.style.fill = this.value;
  });

  let bottom = document.getElementById('bottom');
  let colorPicker5 = document.getElementById('colorPicker5');
  colorPicker5.value = "#00F000";
  colorPicker5.addEventListener('change', function(){
    bottom.style.fill = this.value;
  });

  let leftbottom = document.getElementById('leftbottom');
  let colorPicker6 = document.getElementById('colorPicker6');
  colorPicker6.value = "#00F000";
  colorPicker6.addEventListener('change', function(){
    leftbottom.style.fill = this.value;
  });

  let left = document.getElementById('left');
  let colorPicker7 = document.getElementById('colorPicker7');
  colorPicker7.value = "#00F000";
  colorPicker7.addEventListener('change', function(){
    left.style.fill = this.value;
  });

  let lefttop = document.getElementById('lefttop');
  let colorPicker8 = document.getElementById('colorPicker8');
  colorPicker8.value = "#00F000";
  colorPicker8.addEventListener('change', function(){
    lefttop.style.fill = this.value;
  });


  // var svg = '<svg> +
  // '<path d="M 130 130 C 120 110, 40 110, 30 130
  //         M 130 130 C 120 150, 40 150, 30 130" stroke="black" stroke-width="2" fill="white" id="left"/>' +
  // '<path d="M 130 130 C 140 110, 220 110, 230 130
  //         M 130 130 C 140 150, 220 150, 230 130" stroke="black" stroke-width="2" fill="white" id="right"/>' +

  // '<path d="M 130 130 C 110 120, 110 40, 130 30
  //         M 130 130 C 150 120, 150 40, 130 30" stroke="black" stroke-width="2" fill="white" id="toptop"/>' +

  // '<path d="M 130 130 C 110 140, 110 220, 130 230
  //         M 130 130 C 150 140, 150 220, 130 230" stroke="black" stroke-width="2" fill="white" id="bottom"/>' +

  // '<path d="M 130 130 C 120 90, 100 70, 60 60
  //         M 130 130 C 90 120, 70 110, 60 60" stroke="black" stroke-width="2" fill="white" id="lefttop"/>' +

  // '<path d="M 130 130 C 90 140, 70 170, 60 210
  //         M 130 130 C 120 170, 110 190, 60 210" stroke="black" stroke-width="2" fill="white" id="leftbottom"/>' +

  // '<path d="M 130 130 C 140 90, 160 70, 200 60
  //         M 130 130 C 170 120, 190 110, 200 60" stroke="black" stroke-width="2" fill="white" id="righttop"/>' +

  // '<path d="M 130 130 C 140 170, 150 190, 200 210
  //         M 130 130 C 170 140, 190 170, 200 210" stroke="black" stroke-width="2" fill="white" id="rightbottom"/>' + </svg>'

  window.onload = function() {
      paintSvgToCanvas(document.getElementById('svg'), document.getElementById('canvas'));
  }



  function paintSvgToCanvas(uSvg, uCanvas) {
      var pbx = document.createElement('img');
      pbx.style.width  = uSvg.style.width;
      pbx.style.height = uSvg.style.height;
      pbx.src = 'data:image/svg+xml;base64,' + window.btoa(uSvg.outerHTML);
      uCanvas.getContext('2d').drawImage(pbx, 0, 0);

  }



// function importSVG(sourceSVG, targetCanvas) {
//     // https://developer.mozilla.org/en/XMLSerializer
//     var svg_xml = (new XMLSerializer()).serializeToString(sourceSVG);
//     var ctx = targetCanvas.getContext('2d');

//     // this is just a JavaScript (HTML) image
//     var img = new Image();
//     // http://en.wikipedia.org/wiki/SVG#Native_support
//     // https://developer.mozilla.org/en/DOM/window.btoa
//     img.src = "data:image/svg+xml;base64," + btoa(svg_xml);

//     img.onload = function() {
//         // after this, Canvas’ origin-clean is DIRTY
//         ctx.drawImage(img, 0, 0);
//     };
// }



    // let toptop = document.getElementById('toptop');
    // let colorPicker1 = document.getElementById('colorPicker1');
    // colorPicker1.value = "#00F000";
    // colorPicker1.addEventListener('change', function(){
    //   toptop.style.fill = this.value;
    // });

    // let righttop = document.getElementById('righttop');
    // let colorPicker2 = document.getElementById('colorPicker2');
    // colorPicker2.value = "#00F000";
    // colorPicker2.addEventListener('change', function(){
    //   righttop.style.fill = this.value;
    // });

    // let right = document.getElementById('right');
    // let colorPicker3 = document.getElementById('colorPicker3');
    // colorPicker3.value = "#00F000";
    // colorPicker3.addEventListener('change', function(){
    //   right.style.fill = this.value;
    // });

    // let rightbottom = document.getElementById('rightbottom');
    // let colorPicker4 = document.getElementById('colorPicker4');
    // colorPicker4.value = "#00F000";
    // colorPicker4.addEventListener('change', function(){
    //   rightbottom.style.fill = this.value;
    // });

    // let bottom = document.getElementById('bottom');
    // let colorPicker5 = document.getElementById('colorPicker5');
    // colorPicker5.value = "#00F000";
    // colorPicker5.addEventListener('change', function(){
    //   bottom.style.fill = this.value;
    // });

    // let leftbottom = document.getElementById('leftbottom');
    // let colorPicker6 = document.getElementById('colorPicker6');
    // colorPicker6.value = "#00F000";
    // colorPicker6.addEventListener('change', function(){
    //   leftbottom.style.fill = this.value;
    // });

    // let left = document.getElementById('left');
    // let colorPicker7 = document.getElementById('colorPicker7');
    // colorPicker7.value = "#00F000";
    // colorPicker7.addEventListener('change', function(){
    //   left.style.fill = this.value;
    // });

    // let lefttop = document.getElementById('lefttop');
    // let colorPicker8 = document.getElementById('colorPicker8');
    // colorPicker8.value = "#00F000";
    // colorPicker8.addEventListener('change', function(){
    //   lefttop.style.fill = this.value;
    // });

</script>

