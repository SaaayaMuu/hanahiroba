<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Sample</title>
  <style>
    .image {
      margin: 0 auto;
      display: flex;
      align-items: center;
      width: 900px;
    }
    .image__svg {
      width: 400px;
    }
    .image__sep {
      flex-grow: 1;
      text-align: center;
    }
    .image__converted {
      width: 400px;
      height: 400px;
      border: 1px solid rgba(0, 0, 0, 0.5);
    }
  </style>
</head>
<body>
<div class="image">
  <div class="image__svg">
    <svg
      id="svg"
      xmlns="http://www.w3.org/2000/svg"
      width="400"
      height="400"
      viewBox="0 0 400 400"
      preserveAspectRatio="xMidYMid meet"
      style="background-color: #eee;">
      <path d="M 130 130 C 120 110, 40 110, 30 130
               M 130 130 C 120 150, 40 150, 30 130"  fill="rgba(255,0,0,0.5)" />

      <!--右真横　上＆下-->
      <path d="M 130 130 C 140 110, 220 110, 230 130
               M 130 130 C 140 150, 220 150, 230 130" fill="rgba(255,0,0,0.5)"/>

      <!--上　左＆右-->
      <path d="M 130 130 C 110 120, 110 40, 130 30
               M 130 130 C 150 120, 150 40, 130 30"  fill="rgba(255,0,0,0.5)"/>

      <!--下　左＆右-->
      <path d="M 130 130 C 110 140, 110 220, 130 230
               M 130 130 C 150 140, 150 220, 130 230" fill="rgba(255,0,0,0.5)"/>

      <!--左上　右&左-->
      <path d="M 130 130 C 120 90, 100 70, 60 60
               M 130 130 C 90 120, 70 110, 60 60"  fill="rgba(255,0,0,0.5)" />

      <!--左下　左＆右-->
      <path d="M 130 130 C 90 140, 70 170, 60 210
               M 130 130 C 120 170, 110 190, 60 210" fill="rgba(255,0,0,0.5)"/>

      <!--右上　左＆右-->
      <path d="M 130 130 C 140 90, 160 70, 200 60
               M 130 130 C 170 120, 190 110, 200 60" fill="rgba(255,0,0,0.5)"/>

      <!--右下　左＆右-->
      <path d="M 130 130 C 140 170, 150 190, 200 210
               M 130 130 C 170 140, 190 170, 200 210" fill="rgba(255,0,0,0.5)"/>
    </svg>


    <div>
      <label>①の色選択
        <input id="colorPicker1" type="color" name="favorite_color">
        <!--<span id="output"></span>-->
      </label><br>
      <label>②の色選択
        <input id="colorPicker2" type="color" name="favorite_color">
        <!--<span id="output"></span>-->
      </label><br>
      <label>③の色選択
        <input id="colorPicker3" type="color" name="favorite_color">
        <!--<span id="output"></span>-->
      </label><br>
      <label>④の色選択
        <input id="colorPicker4" type="color" name="favorite_color">
        <!--<span id="output"></span>-->
      </label><br>
      <label>⑤の色選択
        <input id="colorPicker5" type="color" name="favorite_color">
        <!--<span id="output"></span>-->
      </label><br>
      <label>⑥の色選択
        <input id="colorPicker6" type="color" name="favorite_color">
        <!--<span id="output"></span>-->
      </label><br>
      <label>⑦の色選択
        <input id="colorPicker7" type="color" name="favorite_color">
        <!--<span id="output"></span>-->
      </label><br>
      <label>⑧の色選択
        <input id="colorPicker8" type="color" name="favorite_color">
        <!--<span id="output"></span>-->
      </label>
    </div>


  </div>
  <div class="image__sep">
    <div>==&gt;&gt;</div>
    <div><button id="convert-button">変換する</button></div>
  </div>
  <div class="image__converted">
    <img src="" id="converted-image">
  </div>
</div>
<script>

    let toptop = document.getElementById('toptop');
    let colorPicker1 = document.getElementById('colorPicker1');
    colorPicker1.value = "#00F000";
    colorPicker1.addEventListener('change', function(){
      toptop.style.fill = this.value;
    });

    let righttop = document.getElementById('righttop');
    let colorPicker2 = document.getElementById('colorPicker2');
    colorPicker2.value = "#00F000";
    colorPicker2.addEventListener('change', function(){
      righttop.style.fill = this.value;
    });

    let right = document.getElementById('right');
    let colorPicker3 = document.getElementById('colorPicker3');
    colorPicker3.value = "#00F000";
    colorPicker3.addEventListener('change', function(){
      right.style.fill = this.value;
    });

    let rightbottom = document.getElementById('rightbottom');
    let colorPicker4 = document.getElementById('colorPicker4');
    colorPicker4.value = "#00F000";
    colorPicker4.addEventListener('change', function(){
      rightbottom.style.fill = this.value;
    });

    let bottom = document.getElementById('bottom');
    let colorPicker5 = document.getElementById('colorPicker5');
    colorPicker5.value = "#00F000";
    colorPicker5.addEventListener('change', function(){
      bottom.style.fill = this.value;
    });

    let leftbottom = document.getElementById('leftbottom');
    let colorPicker6 = document.getElementById('colorPicker6');
    colorPicker6.value = "#00F000";
    colorPicker6.addEventListener('change', function(){
      leftbottom.style.fill = this.value;
    });

    let left = document.getElementById('left');
    let colorPicker7 = document.getElementById('colorPicker7');
    colorPicker7.value = "#00F000";
    colorPicker7.addEventListener('change', function(){
      left.style.fill = this.value;
    });

    let lefttop = document.getElementById('lefttop');
    let colorPicker8 = document.getElementById('colorPicker8');
    colorPicker8.value = "#00F000";
    colorPicker8.addEventListener('change', function(){
      lefttop.style.fill = this.value;
    });




  (function() {
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('convert-button').addEventListener('click', function() {
        svg2imageData(document.getElementById('svg'), function(data) {
          console.log(data);
          document.getElementById('converted-image').src = data;
        }, function(error) {
          console.log(error);
          alert('failed to convert');
        });
      });
    });
    function svg2imageData(svgElement, successCallback, errorCallback) {
      var canvas = document.createElement('canvas');
      canvas.width = svgElement.width.baseVal.value;
      canvas.height = svgElement.height.baseVal.value;
      var ctx = canvas.getContext('2d');
      var image = new Image();
      image.onload = () => {
        ctx.drawImage(image, 0, 0, image.width, image.height);
        successCallback(canvas.toDataURL());
      };
      image.onerror = (e) => {
        errorCallback(e);
      };
      var svgData = new XMLSerializer().serializeToString(svgElement);
      image.src = 'data:image/svg+xml;charset=utf-8;base64,' + btoa(svgData);
    }
  }());
</script>
</body>
</html>